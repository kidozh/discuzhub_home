{"version":3,"file":"component---src-pages-test-my-bbs-js-af70b4069d67826f8bbf.js","mappings":"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","sources":["webpack://gatsby-starter-hello-world/./src/pages/test-my-bbs.js"],"sourcesContent":["import React from \"react\"\nimport DocLayout from \"../components/doc-layout\"\nimport { Box, Grid, Link, Alert, Input, Label, Button, Spinner } from 'theme-ui'\nimport { injectIntl } from \"gatsby-plugin-intl\"\n\n\n\nclass TestPage extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            url: \"\",\n            warn: \"\",\n            apiResult: \"\",\n            apiJSON: null,\n            response: null,\n            ok: false,\n            code: 200,\n            isLoading: false\n        }\n        this.handleURLChange = this.handleURLChange.bind(this)\n        this.giveURLSuggestion = this.giveURLSuggestion.bind(this)\n        this.sendAjaxRequest = this.sendAjaxRequest.bind(this)\n        this.setCodeResult = this.setCodeResult.bind(this)\n        this.setResponseResult = this.setResponseResult.bind(this)\n\n    }\n\n\n    handleURLChange(event) {\n        this.setState({\n            url: event.target.value\n        })\n        this.giveURLSuggestion()\n    }\n\n    checkURL(URL) {\n        var str = URL;\n        //判断URL地址的正则表达式为:http(s)?://([\\w-]+\\.)+[\\w-]+(/[\\w- ./?%&=]*)?\n        //下面的代码中应用了转义字符\"\\\"输出一个字符\"/\"\n        var Expression = /http(s)?:\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- .\\/?%&=]*)?/;\n        var objExp = new RegExp(Expression);\n        if (objExp.test(str) == true) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    getFullApiUrl(header) {\n        return header + \"/api/mobile/index.php?version=4&module=check\";\n    }\n\n    setCodeResult(response, json) {\n        this.setState({\n            \"apiResult\": response,\n            \"apiJSON\": json\n        })\n    }\n\n    clearResult(){\n        this.setState({\n            \"apiResult\":null,\n            \"apiJSON\":null\n        })\n    }\n\n    setResponseResult(ok, response) {\n        this.setState({\n            \"response\": response,\n            \"ok\": ok\n\n        })\n    }\n\n    sendAjaxRequest() {\n        const { intl } = this.props;\n        this.clearResult()\n        \n        const url = this.getFullApiUrl(this.state.url);\n        \n\n\n        var proxyUrl = 'https://cors-anywhere.herokuapp.com/'\n        this.state.isLoading = true\n        fetch(proxyUrl + url, {\n            method: 'GET',\n            credentials: 'same-origin',\n            'X-Requested-With': 'XMLHttpRequest'\n\n        }).then(response => {\n            //setResponseResult(true,response)\n            this.setState({\n                \"ok\":response.ok,\n                \"code\":response.status,\n                \"isLoading\":false\n            })\n            console.log(response);\n            //this.setResponseResult(response.ok,response)\n            return response.text()\n\n        }).then(text => {\n            this.setCodeResult(text, null)\n            var json = JSON.parse(text)\n            console.log(text)\n            console.log(json)\n            this.setCodeResult(text, json)\n            this.setState({\n                ok: true\n            })\n        })\n            .catch(function (error) {\n                console.log(error)\n                \n            })\n    }\n\n    checkBBSResultOk(){\n        if(this.state.apiJSON!=null && this.state.apiJSON.sitename!=null){\n            return true;\n        }\n        else{\n            return false;\n        }\n    }\n\n    setURL(urlString){\n        //this.url = urlString\n        this.setState({\n            url:urlString\n        })\n    }\n\n\n    giveURLSuggestion() {\n        const { intl } = this.props;\n        const url = this.state.url;\n        if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) {\n            // ok with protocol\n            if (this.checkURL(url)) {\n                this.setState({\n                    warn: \"\"\n                })\n            }\n            else {\n                this.setState({\n                    warn: intl.formatMessage({ id: \"test-my-bbs.warn_enter_to_check_problem\" })\n                })\n            }\n        }\n        else {\n            this.setState({\n                warn: intl.formatMessage({ id: \"test-my-bbs.warn_need_protocol\" })\n            })\n        }\n    }\n\n    componentDidMount() {\n\n    }\n\n    render() {\n        const { intl } = this.props;\n        var url = this.state.url;\n        var state = this.state;\n        return (\n            <DocLayout subject={intl.formatMessage({ id: \"test-my-bbs.title\" })}>\n                <Grid>\n                    <Box>\n                        <Label htmlFor='bbs_url'>{intl.formatMessage({ id: \"test-my-bbs.url\" })}</Label>\n                        <Input\n                            name='bbs_url'\n                            mb={3}\n                            type=\"url\"\n                            onChange={this.handleURLChange}\n                            value={url}\n                        />\n                        <p><small>*:{intl.formatMessage({ id: \"test-my-bbs.redirect_by_cross_anywhere\" })}</small></p>\n                        <p>\n                        {intl.formatMessage({ id: \"test-my-bbs.example\" })}\n                        </p>\n                        <ul>\n                            <li><Link href=\"#\" onClick={(e) => this.setURL(\"https://www.mcbbs.net\")}>https://www.mcbbs.net</Link></li>\n                            <li><Link href=\"#\" onClick={(e) => this.setURL(\"https://keylol.com\")}>https://keylol.com</Link></li>\n                            \n                        </ul>\n                        \n\n                        {\n                            this.checkURL(url) &&\n\n                            <p sx={{\n                                m: 0,\n                                color: 'primary'\n                            }}>\n                                {intl.formatMessage({ id: \"test-my-bbs.api_full_text\" }, {\n                                    fullApi: \"\"\n                                })}\n                                <Link href={this.getFullApiUrl(url)}>{this.getFullApiUrl(url)}</Link>\n                            </p>\n\n                        }\n                        \n                        {\n                            this.checkURL(url) &&\n                            <Button\n                                variant=\"success\"\n                                onClick={this.sendAjaxRequest}\n                                sx={{\n                                    mt: 2,\n                                    bg:\"blue\"\n\n                                }}>\n                                {\n                                    intl.formatMessage({ id: \"test-my-bbs.submit\" })}</Button>\n                        }\n\n\n\n                    </Box>\n                </Grid>\n                <Grid columns={1} mt={2}>\n                    <box>\n                        {state.isLoading&&(\n                        \n                        <p>\n                            <Spinner />\n                            {intl.formatMessage({ id: \"test-my-bbs.loading_data\" },{\"url\":url})}\n                        </p>)\n                        }\n                    </box>\n                    {this.state.apiResult && \n                    (\n                        <box>\n                        {\n                        this.checkBBSResultOk()?\n                        (\n                            <Alert variant='secondary' mb={2} sx={{\n                                bg:\"green\"\n                            }}>{intl.formatMessage({ id: \"test-my-bbs.app_add_guide\" },{\n                                \"url\":url,\n                                \"name\":state.apiJSON.sitename\n                            })}</Alert>\n                            \n                            \n                        ):(\n                            <Alert variant='secondary' mb={2}>{intl.formatMessage({ id: \"test-my-bbs.bbs_not_pass_result\" })}</Alert>\n                        )\n                        \n                        }\n                    </box>\n                    )\n                    \n                    }\n                    \n                </Grid>\n                <Grid columns={[1, 2, 2]}\n                    sx={{\n                        mt: 4,\n                        mb: 4\n                    }}\n                >\n                    {this.state.apiResult &&\n                        <Box>\n                            <h3>{intl.formatMessage({ id: \"test-my-bbs.raw_result\" })}</h3>\n                            <pre\n                                css={{\n                                    overflow: \"scroll\",\n                                }}\n                            >{this.state.apiResult}\n                            </pre>\n                        </Box>\n                    }\n                    {this.state.apiJSON &&\n                        <Box>\n                            <h3>{intl.formatMessage({ id: \"test-my-bbs.attributes\" })}</h3>\n                            <table>\n                                <thead>\n                                    <tr sx={{\n                                        bg: \"primary\"\n                                    }}>\n                                        <th>{intl.formatMessage({ id: \"test-my-bbs.key\" })}</th>\n                                        <th>{intl.formatMessage({ id: \"test-my-bbs.value\" })}</th>\n                                        <th>{intl.formatMessage({ id: \"test-my-bbs.compatible\" })}</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.discuz_version\" })}</td>\n                                        <td>{this.state.apiJSON.discuzversion}</td>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.yes\" })}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.charset\" })}</td>\n                                        <td>{this.state.apiJSON.charset}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.plugin_version\" })}</td>\n                                        <td>{this.state.apiJSON.pluginversion}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.register_name\" })}</td>\n                                        <td>{this.state.apiJSON.regname}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.qq_connect\" })}</td>\n                                        <td>{this.state.apiJSON.qqconnect}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.hide_register\" })}</td>\n                                        <td>{this.state.apiJSON.wsqhideregister}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.site_name\" })}</td>\n                                        <td>{this.state.apiJSON.sitename}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.site_id\" })}</td>\n                                        <td>{this.state.apiJSON.mysiteid}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.ucenter_url\" })}</td>\n                                        <td>{this.state.apiJSON.ucenterurl}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.default_fid\" })}</td>\n                                        <td>{this.state.apiJSON.defaultfid}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.total_post\" })}</td>\n                                        <td>{this.state.apiJSON.totalposts}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.total_members\" })}</td>\n                                        <td>{this.state.apiJSON.totalmembers}</td>\n                                        <td>/</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{intl.formatMessage({ id: \"test-my-bbs.test_cookie\" })}</td>\n                                        <td>{this.state.apiJSON.testcookie}</td>\n                                        <td>/</td>\n                                    </tr>\n                                </tbody>\n\n                            </table>\n                        </Box>\n                    }\n\n\n\n                </Grid>\n            </DocLayout>\n        )\n    }\n\n}\n\n\n\nexport default injectIntl(TestPage)"],"names":["TestPage","props","state","url","warn","apiResult","apiJSON","response","ok","code","isLoading","handleURLChange","bind","giveURLSuggestion","sendAjaxRequest","setCodeResult","setResponseResult","event","this","setState","target","value","checkURL","URL","str","RegExp","test","getFullApiUrl","header","json","clearResult","intl","fetch","method","credentials","then","status","console","log","text","JSON","parse","catch","error","checkBBSResultOk","sitename","setURL","urlString","startsWith","formatMessage","id","componentDidMount","render","subject","htmlFor","name","mb","type","onChange","href","onClick","e","sx","m","color","fullApi","variant","mt","bg","columns","css","overflow","discuzversion","charset","pluginversion","regname","qqconnect","wsqhideregister","mysiteid","ucenterurl","defaultfid","totalposts","totalmembers","testcookie","React","injectIntl"],"sourceRoot":""}